<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Ultrasound-based ECG Monitor</title>
  <link rel="stylesheet" href="style.css" />
</head>
<body>
  <header class="app-header">
    <h1>Ultrasound-based ECG Monitor</h1>
  </header>

  <main class="app-main">
    <!-- Top control row -->
    <section class="controls-row">
      <button id="startButton">Start</button>
      <button id="stopButton" disabled>Stop</button>
      <button id="record30Button">Record 30 seconds</button>
    </section>

    <!-- Settings -->
    <section class="settings">
      <div class="setting-group">
        <label>Ultrasound band <span class="sub">(Hz)</span></label>
        <div class="input-row">
          <input id="ultraStart" type="number" value="17000" min="1000" max="40000" step="100" />
          <span class="dash">—</span>
          <input id="ultraEnd" type="number" value="20000" min="1000" max="40000" step="100" />
        </div>
      </div>

      <div class="setting-group">
        <label>Signal band <span class="sub">(Hz)</span></label>
        <div class="input-row">
          <input id="signalHighPass" type="number" value="0.5" min="0" max="20" step="0.01" />
          <span class="dash">—</span>
          <input id="signalLowPass" type="number" value="40" min="10" max="1000" step="1" />
        </div>
      </div>

      <div class="setting-group">
        <label>Signal options</label>
        <div class="input-row">
          <input id="invertSignal" type="checkbox" checked="true"/>
          <span>Invert signal</span>
        </div>
      </div>

    </section>

    <!-- ECG canvas -->
    <section class="canvas-card">
      <canvas id="ecgCanvas"></canvas>
    </section>

    <!-- Metrics -->
    <section id="metrics" class="metrics">
      <div class="metric">
        <span class="label">Heart Rate</span>
        <span class="value"><span id="heartRate">--</span> bpm</span>
      </div>
      <div class="metric">
        <span class="label">HRV (SDNN)</span>
        <span class="value"><span id="hrv">--</span> ms</span>
      </div>
      <!-- NEW: Beat counter (last 600 s) -->
      <div class="metric">
        <span class="label">Beats (last 600s)</span>
        <span class="value"><span id="beatCount">--</span></span>
      </div>
      <div class="metric">
        <span class="label">Ultrasound Level</span>
        <span class="value"><span id="peakLevel">--</span></span>
      </div>
      <div class="metric">
        <span class="label">SNR</span>
        <span class="value"><span id="snr">--</span> dB</span>
      </div>
      <div class="metric status-metric">
        <span class="label">Status</span>
        <span class="value" id="statusText">Idle — click Start.</span>
      </div>
    </section>

    <p class="hint">
      This website and the ECG business card are experimental, for educational use only. They are not medical devices, are not approved by any regulatory authority, and must not be used to diagnose, monitor, or treat any medical condition. Do not rely on them in an emergency; if you have any concerns about your heart or health, seek professional medical help.
    </p>

    <!-- Snapshot image of last 30 s recording (hidden until first recording) -->
    <section id="snapshotSection" class="snapshot hidden">
      <h2>Last 30 s snapshot</h2>
      <img id="snapshotImage" alt="30 s ECG snapshot" />
      <a id="csvDownloadLink" class="download-link" href="#" download="ecg_snapshot.csv">
        Download 30 s ECG as CSV
      </a>
    </section>
  </main>

  <script src="script.js"></script>
</body>
</html>
